//
//  ComposingTypes.swift
//  SwiftBySundell
//
//  Created by Vladislav Gushin on 11/03/2019.
//  Copyright Â© 2019 Vladislav Gushin. All rights reserved.
//

import UIKit
/*ÐšÐ¾Ð¼Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ñ - ÑÑ‚Ð¾ Ð¾Ñ‡ÐµÐ½ÑŒ Ð¿Ð¾Ð»ÐµÐ·Ð½Ñ‹Ð¹ Ð¼ÐµÑ‚Ð¾Ð´, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ Ð½Ð°Ð¼ Ñ€Ð°Ð·Ð´ÐµÐ»ÑÑ‚ÑŒ ÐºÐ¾Ð´ Ð¼ÐµÐ¶Ð´Ñƒ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¸Ð¼Ð¸ Ñ‚Ð¸Ð¿Ð°Ð¼Ð¸ Ð² Ð±Ð¾Ð»ÐµÐµ Ð½ÐµÑÐ²ÑÐ·Ð½Ð¾Ð¹ Ñ„Ð¾Ñ€Ð¼Ðµ. Ð­Ñ‚Ð¾ Ñ‡Ð°ÑÑ‚Ð¾ Ð¿Ñ€ÐµÐ¿Ð¾Ð´Ð½Ð¾ÑÐ¸Ñ‚ÑÑ ÐºÐ°Ðº Ð°Ð»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð° Ð¿Ð¾Ð´ÐºÐ»Ð°ÑÑÐ°Ð¼, Ñ Ñ‚Ð°ÐºÐ¸Ð¼Ð¸ Ñ„Ñ€Ð°Ð·Ð°Ð¼Ð¸, ÐºÐ°Ðº Â«ÐšÐ¾Ð¼Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ñ Ð½Ð°Ð´ Ð½Ð°ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼Â» - Ð¸Ð´ÐµÑ Ð¾Ð±ÑŠÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹ Ð¸Ð· Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¸Ñ… Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ñ‡Ð°ÑÑ‚ÐµÐ¹ Ð²Ð¼ÐµÑÑ‚Ð¾ Ñ‚Ð¾Ð³Ð¾, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¿Ð¾Ð»Ð°Ð³Ð°Ñ‚ÑŒÑÑ Ð½Ð° Ð´ÐµÑ€ÐµÐ²Ð¾ Ð½Ð°ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ð½Ð¸Ñ.
 
 Ð¥Ð¾Ñ‚Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¿Ð¾Ð´ÐºÐ»Ð°ÑÑÐ¾Ð² / Ð½Ð°ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ‚Ð°ÐºÐ¶Ðµ ÑÐ²Ð»ÑÐµÑ‚ÑÑ Ñ‡Ñ€ÐµÐ·Ð²Ñ‹Ñ‡Ð°Ð¹Ð½Ð¾ Ð¿Ð¾Ð»ÐµÐ·Ð½Ñ‹Ð¼ (Ð¸ Ñ„Ñ€ÐµÐ¹Ð¼Ð²Ð¾Ñ€ÐºÐ¸ Apple, Ð¾Ñ‚ ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ñ… Ð¼Ñ‹ Ð²ÑÐµ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼, Ð² Ð·Ð½Ð°Ñ‡Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð¹ ÑÑ‚ÐµÐ¿ÐµÐ½Ð¸ Ð·Ð°Ð²Ð¸ÑÑÑ‚ Ð¾Ñ‚ ÑÑ‚Ð¾Ð³Ð¾ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ð°), ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚ Ð¼Ð½Ð¾Ð³Ð¾ ÑÐ¸Ñ‚ÑƒÐ°Ñ†Ð¸Ð¹, Ð² ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ñ… Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð¼Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¸ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¿Ð¾Ð·Ð²Ð¾Ð»Ð¸Ñ‚ÑŒ Ð²Ð°Ð¼ Ð½Ð°Ð¿Ð¸ÑÐ°Ñ‚ÑŒ Ð±Ð¾Ð»ÐµÐµ Ð¿Ñ€Ð¾ÑÑ‚Ð¾Ð¹ Ð¸ Ð½Ð°Ð´ÐµÐ¶Ð½Ð¾ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ ÐºÐ¾Ð´.
 
 ÐÐ° ÑÑ‚Ð¾Ð¹ Ð½ÐµÐ´ÐµÐ»Ðµ Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ñ€Ð°ÑÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ð¼ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ñ‚Ð°ÐºÐ¸Ñ… ÑÐ¸Ñ‚ÑƒÐ°Ñ†Ð¸Ð¹ Ð¸ Ñ‚Ð¾, ÐºÐ°Ðº Ð¼Ð¾Ð¶Ð½Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ ÐºÐ¾Ð¼Ð¿Ð¾Ð·Ð¸Ñ†Ð¸ÑŽ ÑÐ¾ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð°Ð¼Ð¸, ÐºÐ»Ð°ÑÑÐ°Ð¼Ð¸ Ð¸ Ð¿ÐµÑ€ÐµÑ‡Ð¸ÑÐ»ÐµÐ½Ð¸ÑÐ¼Ð¸ Ð² Swift.*/

// MARK: - Struct composition

/*Ð”Ð¾Ð¿ÑƒÑÑ‚Ð¸Ð¼, Ð¼Ñ‹ Ð¿Ð¸ÑˆÐµÐ¼ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ð´Ð»Ñ ÑÐ¾Ñ†Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ñ… ÑÐµÑ‚ÐµÐ¹, Ð² ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¼ ÐµÑÑ‚ÑŒ Ð¼Ð¾Ð´ÐµÐ»ÑŒ User Ð¸ Ð¼Ð¾Ð´ÐµÐ»ÑŒ Friend. ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ°Ñ Ð¼Ð¾Ð´ÐµÐ»ÑŒ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð´Ð»Ñ Ð²ÑÐµÑ… Ñ‚Ð¸Ð¿Ð¾Ð² Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹ Ð² Ð½Ð°ÑˆÐµÐ¼ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ð¸, Ð° Ð¼Ð¾Ð´ÐµÐ»ÑŒ Ð´Ñ€ÑƒÐ·ÐµÐ¹ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ Ñ‚Ðµ Ð¶Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ, Ñ‡Ñ‚Ð¾ Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ðµ, Ð½Ð¾ Ñ‚Ð°ÐºÐ¶Ðµ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐµÑ‚ Ð½Ð¾Ð²ÑƒÑŽ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ - Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð½Ð° Ð´Ð°Ñ‚Ñƒ, ÐºÐ¾Ð³Ð´Ð° Ð´Ð²Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ ÑÑ‚Ð°Ð»Ð¸ Ð´Ñ€ÑƒÐ·ÑŒÑÐ¼Ð¸.
 
 ÐŸÑ€Ð¸ Ð¿Ñ€Ð¸Ð½ÑÑ‚Ð¸Ð¸ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ Ð¾ Ñ‚Ð¾Ð¼, ÐºÐ°Ðº Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑŒ ÑÑ‚Ð¸ Ð¼Ð¾Ð´ÐµÐ»Ð¸, Ð¿ÐµÑ€Ð²Ð¾Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ð¸Ð´ÐµÐµÐ¹ (Ð¾ÑÐ¾Ð±ÐµÐ½Ð½Ð¾ ÐµÑÐ»Ð¸ Ð²Ñ‹ Ð¿Ñ€Ð¸ÑˆÐ»Ð¸ Ð¸Ð· ÑÐ·Ñ‹ÐºÐ¾Ð², ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ñ‚Ñ€Ð°Ð´Ð¸Ñ†Ð¸Ð¾Ð½Ð½Ð¾ Ð¾Ð¿Ð¸Ñ€Ð°Ð»Ð¸ÑÑŒ Ð½Ð° Ð½Ð°ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ð½Ð¸Ðµ, Ñ‚Ð°ÐºÐ¸Ñ… ÐºÐ°Ðº Objective-C) Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ ÑÐ´ÐµÐ»Ð°Ñ‚ÑŒ Friend Ð¿Ð¾Ð´ÐºÐ»Ð°ÑÑÐ¾Ð¼ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐµÑ‚ Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ, ÐºÐ°Ðº ÑÑ‚Ð¾:
*/

fileprivate class User {
    var name: String
    var age: Int

    init(name: String, age: Int) {
        self.name = name
        self.age = age
    }
}

fileprivate class Friend: User {
    var friendshipDate: Date
    init(name: String, age: Int, friendshipDate: Date) {
        self.friendshipDate = friendshipDate
        super.init(name: name, age: age)
    }
}

/*Ð¥Ð¾Ñ‚Ñ Ð²Ñ‹ÑˆÐµÑÐºÐ°Ð·Ð°Ð½Ð½Ð¾Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚, Ñƒ Ð½ÐµÐ³Ð¾ ÐµÑÑ‚ÑŒ Ð½ÐµÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð½ÐµÐ´Ð¾ÑÑ‚Ð°Ñ‚ÐºÐ¸. Ð¢Ñ€Ð¸ Ð² Ñ‡Ð°ÑÑ‚Ð½Ð¾ÑÑ‚Ð¸:
 
 1)Ð§Ñ‚Ð¾Ð±Ñ‹ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð½Ð°ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ð½Ð¸Ðµ, Ð¼Ñ‹ Ð²Ñ‹Ð½ÑƒÐ¶Ð´ÐµÐ½Ñ‹ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ ÐºÐ»Ð°ÑÑÑ‹, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ ÑÐ²Ð»ÑÑŽÑ‚ÑÑ ÑÑÑ‹Ð»Ð¾Ñ‡Ð½Ñ‹Ð¼Ð¸ Ñ‚Ð¸Ð¿Ð°Ð¼Ð¸. Ð”Ð»Ñ Ð¼Ð¾Ð´ÐµÐ»ÐµÐ¹ ÑÑ‚Ð¾ Ð¾Ð·Ð½Ð°Ñ‡Ð°ÐµÑ‚, Ñ‡Ñ‚Ð¾ Ð¼Ñ‹ Ð¼Ð¾Ð¶ÐµÐ¼ Ð»ÐµÐ³ÐºÐ¾ Ð²Ð²ÐµÑÑ‚Ð¸ Ð¾Ð±Ñ‰ÐµÐµ Ð¸Ð·Ð¼ÐµÐ½ÑÐµÐ¼Ð¾Ðµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ ÑÐ»ÑƒÑ‡Ð°Ð¹Ð½Ð¾. Ð•ÑÐ»Ð¸ Ð¾Ð´Ð½Ð° Ñ‡Ð°ÑÑ‚ÑŒ Ð½Ð°ÑˆÐµÐ¹ ÐºÐ¾Ð´Ð¾Ð²Ð¾Ð¹ Ð±Ð°Ð·Ñ‹ Ð¸Ð·Ð¼ÐµÐ½ÑÐµÑ‚ Ð¼Ð¾Ð´ÐµÐ»ÑŒ, Ð¾Ð½Ð° Ð±ÑƒÐ´ÐµÑ‚ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¾Ñ‚Ñ€Ð°Ð¶Ð°Ñ‚ÑŒÑÑ Ð²ÐµÐ·Ð´Ðµ, Ñ‡Ñ‚Ð¾ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¿Ñ€Ð¸Ð²ÐµÑÑ‚Ð¸ Ðº Ð¾ÑˆÐ¸Ð±ÐºÐ°Ð¼, ÐµÑÐ»Ð¸ Ñ‚Ð°ÐºÐ¸Ðµ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ Ð½Ðµ Ð±ÑƒÐ´ÑƒÑ‚ ÑÐ¾Ð±Ð»ÑŽÐ´ÐµÐ½Ñ‹ Ð¸ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð½Ñ‹ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾.
 2)ÐŸÐ¾ÑÐºÐ¾Ð»ÑŒÐºÑƒ Ð”Ñ€ÑƒÐ³ Ñ‚Ð°ÐºÐ¶Ðµ ÑÐ²Ð»ÑÐµÑ‚ÑÑ ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¼, Ð”Ñ€ÑƒÐ³ Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð¿ÐµÑ€ÐµÐ´Ð°Ð½ Ð² Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°ÑŽÑ‚ ÑÐºÐ·ÐµÐ¼Ð¿Ð»ÑÑ€ ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ. Ð­Ñ‚Ð¾ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¿Ð¾ÐºÐ°Ð·Ð°Ñ‚ÑŒÑÑ Ð±ÐµÐ·Ð²Ñ€ÐµÐ´Ð½Ñ‹Ð¼, Ð½Ð¾ ÑÑ‚Ð¾ ÑƒÐ²ÐµÐ»Ð¸Ñ‡Ð¸Ð²Ð°ÐµÑ‚ Ñ€Ð¸ÑÐº Ð½ÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ Ð½Ð°ÑˆÐµÐ³Ð¾ ÐºÐ¾Ð´Ð°, Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, ÐµÑÐ»Ð¸ ÑÐºÐ·ÐµÐ¼Ð¿Ð»ÑÑ€ Friend Ð¿ÐµÑ€ÐµÐ´Ð°ÐµÑ‚ÑÑ Ñ‚Ð°ÐºÐ¾Ð¹ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸, ÐºÐ°Ðº saveDataForCurrentUser.
 3)Ð”Ð»Ñ Ð´Ñ€ÑƒÐ³Ð° Ð¼Ñ‹ Ð½Ð° ÑÐ°Ð¼Ð¾Ð¼ Ð´ÐµÐ»Ðµ Ð½Ðµ Ñ…Ð¾Ñ‚Ð¸Ð¼, Ñ‡Ñ‚Ð¾Ð±Ñ‹ ÑÐ²Ð¾Ð¹ÑÑ‚Ð²Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð±Ñ‹Ð»Ð¸ Ð¸Ð·Ð¼ÐµÐ½ÑÐµÐ¼Ñ‹Ð¼Ð¸ (Ð´Ð¾Ð²Ð¾Ð»ÑŒÐ½Ð¾ ÑÐ»Ð¾Ð¶Ð½Ð¾ Ð¸Ð·Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ð¸Ð¼Ñ Ð´Ñ€ÑƒÐ³Ð° ðŸ˜…), Ð½Ð¾, Ð¿Ð¾ÑÐºÐ¾Ð»ÑŒÐºÑƒ Ð¼Ñ‹ Ð¿Ð¾Ð»Ð°Ð³Ð°ÐµÐ¼ÑÑ Ð½Ð° Ð½Ð°ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ð½Ð¸Ðµ, Ð¼Ñ‹ Ñ‚Ð°ÐºÐ¶Ðµ Ð½Ð°ÑÐ»ÐµÐ´ÑƒÐµÐ¼ Ð¸Ð·Ð¼ÐµÐ½Ñ‡Ð¸Ð²Ð¾ÑÑ‚ÑŒ Ð²ÑÐµÑ… ÑÐ²Ð¾Ð¹ÑÑ‚Ð².
 Ð”Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ ÐºÐ¾Ð¼Ð¿Ð¾Ð·Ð¸Ñ†Ð¸ÑŽ Ð²Ð¼ÐµÑÑ‚Ð¾ ÑÑ‚Ð¾Ð³Ð¾! Ð”Ð°Ð²Ð°Ð¹Ñ‚Ðµ ÑÐ¾Ð·Ð´Ð°Ð´Ð¸Ð¼ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñ‹ User Ð¸ Friend (Ñ‡Ñ‚Ð¾ Ð¿Ð¾Ð·Ð²Ð¾Ð»Ð¸Ñ‚ Ð½Ð°Ð¼ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð¿Ñ€ÐµÐ¸Ð¼ÑƒÑ‰ÐµÑÑ‚Ð²Ð° Ð²ÑÑ‚Ñ€Ð¾ÐµÐ½Ð½Ñ‹Ñ… Ð² Swift Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹ Ð¸Ð·Ð¼ÐµÐ½Ñ‡Ð¸Ð²Ð¾ÑÑ‚Ð¸), Ð¸ Ð²Ð¼ÐµÑÑ‚Ð¾ Ñ‚Ð¾Ð³Ð¾, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Friend Ð½ÐµÐ¿Ð¾ÑÑ€ÐµÐ´ÑÑ‚Ð²ÐµÐ½Ð½Ð¾ Ñ€Ð°ÑÑˆÐ¸Ñ€ÑÐ» User, Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ ÑÐ¾ÑÑ‚Ð°Ð²Ð¸Ð¼ ÑÐºÐ·ÐµÐ¼Ð¿Ð»ÑÑ€ User Ð²Ð¼ÐµÑÑ‚Ðµ Ñ Ð½Ð¾Ð²Ñ‹Ð¼Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸, Ð¾Ñ‚Ð½Ð¾ÑÑÑ‰Ð¸Ð¼Ð¸ÑÑ Ðº Ð´Ñ€ÑƒÐ³Ñƒ, Ð´Ð»Ñ Ñ„Ð¾Ñ€Ð¼Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ñ‚Ð¸Ð¿Ð° Friend, Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€:
*/

fileprivate struct User1 {
    var name: String
    var age: Int
}

fileprivate struct Friend1 {
    let user: User1
    var friendshipDate: Date
}

// MARK: - Class composition

/*Ð—Ð½Ð°Ñ‡Ð¸Ñ‚ Ð»Ð¸ ÑÑ‚Ð¾, Ñ‡Ñ‚Ð¾ Ð¼Ñ‹ Ð´Ð¾Ð»Ð¶Ð½Ñ‹ ÑÐ¾Ð·Ð´Ð°Ð²Ð°Ñ‚ÑŒ Ð²ÑÐµ Ð½Ð°ÑˆÐ¸ Ñ‚Ð¸Ð¿Ñ‹ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€? Ð¯ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð½Ð¾ Ñ‚Ð°Ðº Ð½Ðµ Ð´ÑƒÐ¼Ð°ÑŽ. ÐšÐ»Ð°ÑÑÑ‹ Ð¾Ñ‡ÐµÐ½ÑŒ Ð¼Ð¾Ñ‰Ð½Ñ‹Ðµ, Ð¸ Ð¸Ð½Ð¾Ð³Ð´Ð° Ð²Ñ‹ Ñ…Ð¾Ñ‚Ð¸Ñ‚Ðµ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð²Ð°ÑˆÐ¸ Ñ‚Ð¸Ð¿Ñ‹ Ð¸Ð¼ÐµÐ»Ð¸ ÑÐµÐ¼Ð°Ð½Ñ‚Ð¸ÐºÑƒ ÑÑÑ‹Ð»Ð¾Ðº, Ð° Ð½Ðµ ÑÐµÐ¼Ð°Ð½Ñ‚Ð¸ÐºÑƒ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ð¹. ÐÐ¾ Ð´Ð°Ð¶Ðµ ÐµÑÐ»Ð¸ Ð¼Ñ‹ Ñ€ÐµÑˆÐ¸Ð¼ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ ÐºÐ»Ð°ÑÑÑ‹, Ð¼Ñ‹ Ð²ÑÐµ Ñ€Ð°Ð²Ð½Ð¾ Ð¼Ð¾Ð¶ÐµÐ¼ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ ÐºÐ¾Ð¼Ð¿Ð¾Ð·Ð¸Ñ†Ð¸ÑŽ Ð² ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ðµ Ð°Ð»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ñ‹ Ð½Ð°ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ð½Ð¸ÑŽ Ð²Ð¾ Ð¼Ð½Ð¾Ð³Ð¸Ñ… ÑÐ¸Ñ‚ÑƒÐ°Ñ†Ð¸ÑÑ….
 
 Ð”Ð°Ð²Ð°Ð¹Ñ‚Ðµ ÑÐ¾Ð·Ð´Ð°Ð´Ð¸Ð¼ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ð¹ Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶Ð°ÐµÑ‚ ÑÐ¿Ð¸ÑÐ¾Ðº Ð½ÐµÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ñ… Ð½Ð°ÑˆÐ¸Ñ… Ð¼Ð¾Ð´ÐµÐ»ÐµÐ¹ Friend Ð¸Ð· Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÐµÐ³Ð¾ Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ð°. ÐœÑ‹ ÑÐ¾Ð·Ð´Ð°Ð´Ð¸Ð¼ ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ð»ÐµÑ€ Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð¸Ñ - Ð½Ð°Ð·Ð¾Ð²ÐµÐ¼ ÐµÐ³Ð¾ FriendListViewController - ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¸Ð¼ÐµÐµÑ‚ UITableView Ð´Ð»Ñ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ Ð½Ð°ÑˆÐ¸Ñ… Ð´Ñ€ÑƒÐ·ÐµÐ¹.
 
 ÐžÐ´Ð¸Ð½ Ð¸Ð· Ð½Ð°Ð¸Ð±Ð¾Ð»ÐµÐµ Ñ€Ð°ÑÐ¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÐµÐ½Ð½Ñ‹Ñ… ÑÐ¿Ð¾ÑÐ¾Ð±Ð¾Ð² Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ð»ÐµÑ€Ð° Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ Ñ‚Ð°Ð±Ð»Ð¸Ñ‡Ð½Ð¾Ð³Ð¾ Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð¸Ñ ÑÐ¾ÑÑ‚Ð¾Ð¸Ñ‚ Ð² Ñ‚Ð¾Ð¼, Ñ‡Ñ‚Ð¾Ð±Ñ‹ ÑÐ°Ð¼ ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ð»ÐµÑ€ Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð±Ñ‹Ð» Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¾Ð¼ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ ÑÐ²Ð¾ÐµÐ³Ð¾ Ñ‚Ð°Ð±Ð»Ð¸Ñ‡Ð½Ð¾Ð³Ð¾ Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð¸Ñ (ÑÑ‚Ð¾ Ð´Ð°Ð¶Ðµ Ñ‚Ð¾, Ðº Ñ‡ÐµÐ¼Ñƒ Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÑÐµÑ‚ÑÑ UITableViewController)
 Ð¯ Ð½Ðµ ÑÐ¾Ð±Ð¸Ñ€Ð°ÑŽÑÑŒ Ð³Ð¾Ð²Ð¾Ñ€Ð¸Ñ‚ÑŒ, Ñ‡Ñ‚Ð¾ Ð´ÐµÐ»Ð°Ñ‚ÑŒ Ð²Ñ‹ÑˆÐµÐ¿ÐµÑ€ÐµÑ‡Ð¸ÑÐ»ÐµÐ½Ð½Ð¾Ðµ Ð¿Ð»Ð¾Ñ…Ð¾, Ð¸ Ð²Ñ‹ Ð½Ð¸ÐºÐ¾Ð³Ð´Ð° Ð½Ðµ Ð´Ð¾Ð»Ð¶Ð½Ñ‹ ÑÑ‚Ð¾Ð³Ð¾ Ð´ÐµÐ»Ð°Ñ‚ÑŒ, Ð½Ð¾ ÐµÑÐ»Ð¸ Ð¼Ñ‹ Ñ…Ð¾Ñ‚Ð¸Ð¼ ÑÐ´ÐµÐ»Ð°Ñ‚ÑŒ ÑÑ‚Ñƒ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ Ð±Ð¾Ð»ÐµÐµ Ñ€Ð°Ð·Ð¾Ð±Ñ‰ÐµÐ½Ð½Ð¾Ð¹ Ð¸ Ð¼Ð½Ð¾Ð³Ð¾ÐºÑ€Ð°Ñ‚Ð½Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼Ð¾Ð¹ - Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð²Ð¼ÐµÑÑ‚Ð¾ ÑÑ‚Ð¾Ð³Ð¾ Ð±ÑƒÐ´ÐµÐ¼ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ ÐºÐ¾Ð¼Ð¿Ð¾Ð·Ð¸Ñ†Ð¸ÑŽ.
 
 ÐœÑ‹ Ð½Ð°Ñ‡Ð½ÐµÐ¼ Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð²Ñ‹Ð´ÐµÐ»ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð¾Ð±ÑŠÐµÐºÑ‚Ð° Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ…, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÐµÑ‚ UITableViewDataSource, ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¼Ñƒ Ð¼Ñ‹ Ð¼Ð¾Ð¶ÐµÐ¼ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð½Ð°Ð·Ð½Ð°Ñ‡Ð¸Ñ‚ÑŒ Ð½Ð°Ñˆ ÑÐ¿Ð¸ÑÐ¾Ðº Ð´Ñ€ÑƒÐ·ÐµÐ¹, Ð¸ Ð¾Ð½ Ð±ÑƒÐ´ÐµÑ‚ ÑÐ½Ð°Ð±Ð¶Ð°Ñ‚ÑŒ Ñ‚Ð°Ð±Ð»Ð¸Ñ‡Ð½Ð¾Ðµ Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾Ð¹ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÐµÐ¹:*/


fileprivate class FriendListTableViewDataSource: NSObject, UITableViewDataSource {
    var friends = [Friend1]()

    func tableView(_ tableView: UITableView,
                   numberOfRowsInSection section: Int) -> Int {
        return friends.count
    }

    func tableView(_ tableView: UITableView,
                   cellForRowAt indexPath: IndexPath) -> UITableViewCell {
        return UITableViewCell(frame: .zero)
    }
}

fileprivate class FriendListViewController: UIViewController {
    private weak var tableView: UITableView!
    private let dataSource = FriendListTableViewDataSource()

    override func viewDidLoad() {
        super.viewDidLoad()
        self.tableView.dataSource = self.dataSource
    }

    func render(_ friends: [Friend1]) {
        dataSource.friends = friends
        tableView.reloadData()
    }
}

/*ÐŸÑ€ÐµÐ»ÐµÑÑ‚ÑŒ ÑÑ‚Ð¾Ð³Ð¾ Ð¿Ð¾Ð´Ñ…Ð¾Ð´Ð° Ð² Ñ‚Ð¾Ð¼, Ñ‡Ñ‚Ð¾ ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑÑ Ð¾Ñ‡ÐµÐ½ÑŒ Ð»ÐµÐ³ÐºÐ¾ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ ÑÑ‚Ñƒ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ, ÐµÑÐ»Ð¸ Ð¼Ñ‹ Ñ…Ð¾Ñ‚Ð¸Ð¼ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð·Ð¸Ñ‚ÑŒ ÑÐ¿Ð¸ÑÐ¾Ðº Ð´Ñ€ÑƒÐ·ÐµÐ¹ Ð³Ð´Ðµ-Ñ‚Ð¾ ÐµÑ‰Ðµ Ð² Ð½Ð°ÑˆÐµÐ¼ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ð¸ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð² Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ¾Ð¼ Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹ÑÐµ Â«ÐÐ°Ð¹Ð´Ð¸ Ð´Ñ€ÑƒÐ³Ð°Â»). Ð’ Ð¾Ð±Ñ‰ÐµÐ¼, ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ðµ Ð¾Ð±ÑŠÐµÐºÑ‚Ð¾Ð² Ð¸Ð· ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ð»ÐµÑ€Ð¾Ð² Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ñ…Ð¾Ñ€Ð¾ÑˆÐ¸Ð¼ ÑÐ¿Ð¾ÑÐ¾Ð±Ð¾Ð¼ Ð¸Ð·Ð±ÐµÐ¶Ð°Ñ‚ÑŒ ÑÐ¸Ð½Ð´Ñ€Ð¾Ð¼Ð° Â«Massive view controllerÂ», Ð¸ Ñ‚Ð¾Ñ‡Ð½Ð¾ Ñ‚Ð°Ðº Ð¶Ðµ, ÐºÐ°Ðº Ð¼Ñ‹ ÑÐ´ÐµÐ»Ð°Ð»Ð¸ Ð½Ð°Ñˆ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸Ðº Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ñ‹Ð¼, ÑÐ¾ÑÑ‚Ð°Ð²Ð½Ñ‹Ð¼ Ñ‚Ð¸Ð¿Ð¾Ð¼ - Ð¼Ñ‹ Ð¼Ð¾Ð¶ÐµÐ¼ ÑÐ´ÐµÐ»Ð°Ñ‚ÑŒ Ñ‚Ð¾ Ð¶Ðµ ÑÐ°Ð¼Ð¾Ðµ Ð´Ð»Ñ Ð´Ñ€ÑƒÐ³Ð¸Ñ… Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹ ( Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¸ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¹, ÐºÑÑˆÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸ Ñ‚. Ð´.).
 
 Ð”Ñ€ÑƒÐ³Ð¾Ð¹ ÑÐ¿Ð¾ÑÐ¾Ð± Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ ÐºÐ¾Ð¼Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¸ Ñ ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ð»ÐµÑ€Ð°Ð¼Ð¸ Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð¸Ñ, Ð² Ñ‡Ð°ÑÑ‚Ð½Ð¾ÑÑ‚Ð¸, ÑÐ¾ÑÑ‚Ð¾Ð¸Ñ‚ Ð² Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ð¸ Ð´Ð¾Ñ‡ÐµÑ€Ð½Ð¸Ñ… ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ð»ÐµÑ€Ð¾Ð² Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð¸Ñ. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ "Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð´Ð¾Ñ‡ÐµÑ€Ð½Ð¸Ñ… ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ð»ÐµÑ€Ð¾Ð² Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð² ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ðµ Ð¿Ð»Ð°Ð³Ð¸Ð½Ð¾Ð² Ð² Swift" Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð¹ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸ Ð¾Ð± ÑÑ‚Ð¾Ð¼.*/

// MARK: - Enum composition
/*ÐÐ°ÐºÐ¾Ð½ÐµÑ†, Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð¿Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ð¼, ÐºÐ°Ðº ÑÐ¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¿ÐµÑ€ÐµÑ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ð¹ Ð¼Ð¾Ð¶ÐµÑ‚ Ð´Ð°Ñ‚ÑŒ Ð½Ð°Ð¼ Ð±Ð¾Ð»ÐµÐµ Ð´ÐµÑ‚Ð°Ð»ÑŒÐ½ÑƒÑŽ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÑƒ, ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¿Ñ€Ð¸Ð²ÐµÑÑ‚Ð¸ Ðº Ð¼ÐµÐ½ÑŒÑˆÐµÐ¼Ñƒ Ð´ÑƒÐ±Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸ÑŽ ÐºÐ¾Ð´Ð°. Ð”Ð¾Ð¿ÑƒÑÑ‚Ð¸Ð¼, Ð¼Ñ‹ ÑÐ¾Ð·Ð´Ð°ÐµÐ¼ Ñ‚Ð¸Ð¿ Operation, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ Ð½Ð°Ð¼ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÑ‚ÑŒ Ñ‚ÑÐ¶ÐµÐ»ÑƒÑŽ Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ Ð² Ñ„Ð¾Ð½Ð¾Ð²Ð¾Ð¼ Ð¿Ð¾Ñ‚Ð¾ÐºÐµ. Ð§Ñ‚Ð¾Ð±Ñ‹ Ð¸Ð¼ÐµÑ‚ÑŒ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ Ñ€ÐµÐ°Ð³Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð½Ð° Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸, Ð¼Ñ‹ ÑÐ¾Ð·Ð´Ð°ÐµÐ¼ Ð¿ÐµÑ€ÐµÑ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ðµ State, Ð² ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¼ ÐµÑÑ‚ÑŒ ÑÐ»ÑƒÑ‡Ð°Ð¸, ÐºÐ¾Ð³Ð´Ð° Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ñ Ð·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÑ‚ÑÑ, Ð·Ð°Ð²ÐµÑ€ÑˆÐ°ÐµÑ‚ÑÑ Ð½ÐµÑƒÐ´Ð°Ñ‡ÐµÐ¹ Ð¸Ð»Ð¸ Ð·Ð°Ð²ÐµÑ€ÑˆÐ°ÐµÑ‚ÑÑ:*/
fileprivate class Operation {
    enum State {
        case loading
        case failed(Error)
        case finished
    }

    private var state = State.loading
    private var action: ()throws -> Void

    init(_ actions: @escaping ()throws -> Void) {
        self.action = actions
    }

    func startWithStateHandler(then handler: (State) -> Void) {
        do {
            try self.action()
            self.state = .finished
            handler(self.state)
        } catch {
            self.state = .failed(error)
            handler(self.state)
        }
    }
}

fileprivate class ImageProcessor {
    func process(image: UIImage)throws {

    }
}

fileprivate class ImageProcessingViewController: UIViewController {
    func processImages(_ images: [UIImage]) {
        let operation = Operation {
            let processor = ImageProcessor()
            try images.forEach(processor.process)
        }

        operation.startWithStateHandler { [weak self] state in
            switch state {
            case .loading:
                self?.showActivityIndicatorIfNeeded()
            case .failed(let error):
                self?.cleanupCache()
                self?.removeActivityIndicator()
                self?.showErrorView(for: error)
            case .finished:
                self?.cleanupCache()
                self?.removeActivityIndicator()
                self?.showFinishedView()
            }
        }
    }

    func cleanupCache() { }
    func removeActivityIndicator() { }
    func showFinishedView() { }
    func showErrorView(for: Error) { }
    func showActivityIndicatorIfNeeded() { }
}

/*ÐÐ° Ð¿ÐµÑ€Ð²Ñ‹Ð¹ Ð²Ð·Ð³Ð»ÑÐ´ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¿Ð¾ÐºÐ°Ð·Ð°Ñ‚ÑŒÑÑ, Ñ‡Ñ‚Ð¾ Ñ Ð²Ñ‹ÑˆÐµÐ¿Ñ€Ð¸Ð²ÐµÐ´ÐµÐ½Ð½Ñ‹Ð¼ ÐºÐ¾Ð´Ð¾Ð¼ Ð½Ðµ Ð²ÑÐµ Ð² Ð¿Ð¾Ñ€ÑÐ´ÐºÐµ, Ð½Ð¾ ÐµÑÐ»Ð¸ Ð¼Ñ‹ Ð¿Ð¾Ð±Ð»Ð¸Ð¶Ðµ Ñ€Ð°ÑÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ð¼, ÐºÐ°Ðº Ð¼Ñ‹ ÑÐ¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ÑÑ Ñ Ð½ÐµÑƒÐ´Ð°Ñ‡Ð½Ñ‹Ð¼Ð¸ Ð¸ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð½Ñ‹Ð¼Ð¸ ÑÐ»ÑƒÑ‡Ð°ÑÐ¼Ð¸, Ð¼Ñ‹ Ð¼Ð¾Ð¶ÐµÐ¼ ÑƒÐ²Ð¸Ð´ÐµÑ‚ÑŒ, Ñ‡Ñ‚Ð¾ Ð·Ð´ÐµÑÑŒ ÐµÑÑ‚ÑŒ Ð½ÐµÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ðµ Ð´ÑƒÐ±Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð´Ð°.
 
 Ð”ÑƒÐ±Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð´Ð° Ð½Ðµ Ð²ÑÐµÐ³Ð´Ð° Ð¿Ð»Ð¾Ñ…Ð¾, Ð½Ð¾ ÐºÐ¾Ð³Ð´Ð° Ð´ÐµÐ»Ð¾ Ð´Ð¾Ñ…Ð¾Ð´Ð¸Ñ‚ Ð´Ð¾ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ñ€Ð°Ð·Ð»Ð¸Ñ‡Ð½Ñ‹Ñ… ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ð¹, Ð¿Ð¾Ð´Ð¾Ð±Ð½Ñ‹Ñ… ÑÑ‚Ð¾Ð¹, Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾ Ñ…Ð¾Ñ€Ð¾ÑˆÐµÐ¹ Ð¸Ð´ÐµÐµÐ¹ ÑÐ²Ð»ÑÐµÑ‚ÑÑ Ð´ÑƒÐ±Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÐ°Ðº Ð¼Ð¾Ð¶Ð½Ð¾ Ð¼ÐµÐ½ÑŒÑˆÐµÐ³Ð¾ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð° ÐºÐ¾Ð´Ð°. Ð’ Ð¿Ñ€Ð¾Ñ‚Ð¸Ð²Ð½Ð¾Ð¼ ÑÐ»ÑƒÑ‡Ð°Ðµ Ð½Ð°Ð¼ Ð¿Ñ€Ð¸Ð´ÐµÑ‚ÑÑ Ð¿Ð¸ÑÐ°Ñ‚ÑŒ Ð±Ð¾Ð»ÑŒÑˆÐµ Ñ‚ÐµÑÑ‚Ð¾Ð² Ð¸ Ð¿Ñ€Ð¾Ð²Ð¾Ð´Ð¸Ñ‚ÑŒ Ð±Ð¾Ð»ÑŒÑˆÐµ Ñ€ÑƒÑ‡Ð½Ð¾Ð³Ð¾ ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ñ ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ð°, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¿Ñ€Ð¾Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð²ÑÐµ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ñ‹Ðµ Ð¿ÑƒÑ‚Ð¸ Ðº ÐºÐ¾Ð´Ñƒ - Ð¸ Ñ Ð±Ð¾Ð»ÑŒÑˆÐ¸Ð¼ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾Ð¼ Ð´ÑƒÐ±Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð´Ð»Ñ Ð¾ÑˆÐ¸Ð±Ð¾Ðº Ð»ÐµÐ³Ñ‡Ðµ Ð¿Ñ€Ð¾ÑÐºÐ°Ð»ÑŒÐ·Ñ‹Ð²Ð°Ñ‚ÑŒ Ñ‡ÐµÑ€ÐµÐ· Ñ‚Ñ€ÐµÑ‰Ð¸Ð½Ñ‹, ÐºÐ¾Ð³Ð´Ð° Ð¼Ñ‹ Ð¼ÐµÐ½ÑÐµÐ¼ Ð²ÐµÑ‰Ð¸.
 
 Ð­Ñ‚Ð¾ ÐµÑ‰Ðµ Ð¾Ð´Ð½Ð° ÑÐ¸Ñ‚ÑƒÐ°Ñ†Ð¸Ñ, Ð² ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¹ ÐºÐ¾Ð¼Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ñ Ð¾Ñ‡ÐµÐ½ÑŒ ÑƒÐ´Ð¾Ð±Ð½Ð°. Ð’Ð¼ÐµÑÑ‚Ð¾ Ñ‚Ð¾Ð³Ð¾, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¸Ð¼ÐµÑ‚ÑŒ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¾Ð´Ð½Ð¾ Ð¿ÐµÑ€ÐµÑ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ðµ, Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ ÑÐ¾Ð·Ð´Ð°Ð´Ð¸Ð¼ Ð´Ð²Ð° - Ð¾Ð´Ð½Ð¾ Ð´Ð»Ñ Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð½Ð°ÑˆÐµÐ³Ð¾ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ, Ð° Ð´Ñ€ÑƒÐ³Ð¾Ðµ Ð´Ð»Ñ Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð°, Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€:*/

fileprivate class Operation1 {
    enum State {
        case loading
        case finished(Outcome)
    }

    enum Outcome {
        case failed(Error)
        case succeeded
    }

    private var state = State.loading
    private var action: ()throws -> Void

    init(_ actions: @escaping ()throws -> Void) {
        self.action = actions
    }

    func startWithStateHandler(then handler: (State) -> Void) {
        do {
            try self.action()
            self.state = .finished(.succeeded)
            handler(self.state)
        } catch {
            self.state = .finished(.failed(error))
            handler(self.state)
        }
    }
}

fileprivate class ImageProcessingViewController1: UIViewController {
    func processImages(_ images: [UIImage]) {
        let operation = Operation1 {
            let processor = ImageProcessor()
            try images.forEach(processor.process)
        }

        operation.startWithStateHandler { [weak self] state in
            switch state {
            case .loading:
                self?.showActivityIndicatorIfNeeded()
            case .finished(let outcome):
                self?.cleanupCache()
                self?.removeActivityIndicator()
                
                switch outcome {
                case .failed(let error):
                    self?.showErrorView(for: error)
                case .succeeded:
                    self?.showFinishedView()
                }
            }
        }
    }

    func cleanupCache() { }
    func removeActivityIndicator() { }
    func showFinishedView() { }
    func showErrorView(for: Error) { }
    func showActivityIndicatorIfNeeded() { }
}
